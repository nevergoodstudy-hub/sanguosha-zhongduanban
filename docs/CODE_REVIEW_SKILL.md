# Python 项目代码审查 Skill

> 基于 PEP8、Python社区最佳实践、游戏开发规范整理

## 1. 项目结构规范

### 1.1 目录结构
```
project/
├── README.md           # 项目说明（必须）
├── requirements.txt    # 依赖声明（必须）
├── .gitignore         # Git忽略规则（必须）
├── main.py            # 入口文件
├── src/               # 源代码目录
│   ├── __init__.py
│   ├── core/          # 核心模块
│   ├── utils/         # 工具模块
│   └── ...
├── tests/             # 测试目录（必须）
│   ├── __init__.py
│   └── test_*.py
├── docs/              # 文档目录
├── data/              # 数据文件
└── config/            # 配置文件
```

### 1.2 检查项
- [ ] 有 README.md 且内容完整
- [ ] 有 requirements.txt 且版本固定
- [ ] 有 .gitignore 且覆盖常见忽略项
- [ ] 代码模块化，职责分离清晰
- [ ] 无冗余文件和目录

## 2. 代码布局规范

### 2.1 强制规则
- 使用 **4个空格** 缩进（禁止Tab）
- 单行最大长度 **100字符**
- 函数之间 **2个空行**
- 类之间 **2个空行**
- 类中方法 **1个空行**
- 禁止行末分号

### 2.2 空格规则
- 二元运算符两边加空格：`a + b`, `x == y`
- 函数参数默认值不加空格：`func(name="Tom")`
- 逗号后加空格：`[1, 2, 3]`
- 冒号后加空格：`{"key": value}`

## 3. 命名规范

### 3.1 强制规则
| 类型 | 规范 | 示例 |
|------|------|------|
| 变量 | 蛇形命名 | `max_value`, `player_count` |
| 常量 | 全大写+下划线 | `MAX_HP`, `CARD_COUNT` |
| 函数 | 蛇形命名 | `get_user_info()`, `deal_damage()` |
| 类 | 驼峰命名 | `GameEngine`, `CardType` |
| 私有属性 | 单下划线开头 | `_private_method()` |
| 模块 | 全小写 | `engine.py`, `card.py` |

### 3.2 推荐规则
- 布尔变量用 `is_`, `has_`, `can_` 开头
- ID 变量用 `_id` 结尾
- 计数变量用 `_count` 结尾
- 避免单字符变量（循环索引除外）

## 4. 函数规范

### 4.1 强制规则
- 函数长度不超过 **100行**
- 一个函数只做 **一件事**
- 禁止使用可变类型作为默认参数
- 圈复杂度不超过 **10**

### 4.2 推荐规则
- 实例方法第一个参数为 `self`
- 类方法第一个参数为 `cls`
- 使用类型注解

## 5. 导入规范

### 5.1 强制规则
- 一行一个 import
- 导入位于文件顶部
- 禁止通配符导入：`from module import *`

### 5.2 导入顺序
1. 标准库
2. 第三方库
3. 本地模块
（每组之间空一行）

## 6. 注释规范

### 6.1 强制规则
- 块注释使用 `#`，离代码至少2空格
- 公共函数必须有 docstring
- 复杂逻辑必须有注释
- 代码修改同步更新注释

### 6.2 推荐规则
- 待实现功能用 `TODO:` 注释
- 注释说明功能，而非描述代码

## 7. 错误处理规范

### 7.1 强制规则
- 异常捕获粒度要细
- 禁止空 except 块
- 禁止 finally 中 return

### 7.2 推荐规则
- 可预检查的错误用 if 判断
- 返回错误用异常类而非变量

## 8. 测试规范

### 8.1 强制规则
- 测试文件以 `test_` 开头
- 测试函数以 `test_` 开头
- 核心功能必须有单元测试

### 8.2 推荐规则
- 使用 pytest 框架
- 使用 fixture 管理测试数据
- 测试覆盖率 > 70%

## 9. 游戏开发特定规范

### 9.1 架构设计
- **模块化设计**：核心逻辑与UI分离
- **状态管理**：游戏状态集中管理
- **事件系统**：解耦组件通信

### 9.2 卡牌游戏特定
- 卡牌类使用 dataclass
- 卡牌效果使用处理器模式
- 游戏规则可配置化
- 支持回放和日志

## 10. 代码审查 Checklist

### 10.1 结构检查
- [ ] 项目结构符合规范
- [ ] 无冗余文件
- [ ] 模块职责清晰

### 10.2 代码质量
- [ ] 命名规范
- [ ] 函数长度合理
- [ ] 无重复代码
- [ ] 类型注解完整

### 10.3 文档完整性
- [ ] README 完整
- [ ] 公共API有docstring
- [ ] 复杂逻辑有注释

### 10.4 测试覆盖
- [ ] 核心功能有测试
- [ ] 测试可独立运行
- [ ] 无失败测试

### 10.5 安全性
- [ ] 无硬编码敏感信息
- [ ] 输入有验证
- [ ] 异常有处理

---

*生成时间: 2026-01-18*
*参考来源: PEP8, Python社区最佳实践, DeckPy开源项目*
